<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Procviƒçov√°n√≠ n√°sobilky a dƒõlen√≠</title>
    <style>
        body {
            font-family: 'Comic Sans MS', cursive, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f0f8ff;
            text-align: center;
        }
        .container {
            background-color: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
        }
        h1 {
            color: #2c80b9;
            font-size: 28px;
        }
        .problem {
            font-size: 32px;
            margin: 30px 0;
            color: #333;
        }
        input[type="number"] {
            font-size: 24px;
            width: 80px;
            padding: 10px;
            border: 2px solid #2c80b9;
            border-radius: 10px;
            text-align: center;
        }
        button {
            font-size: 20px;
            padding: 10px 20px;
            background-color: #2c80b9;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            margin: 10px;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #1a6ea8;
        }
        .score {
            font-size: 24px;
            margin: 20px 0;
            color: #2c80b9;
        }
        .feedback {
            font-size: 24px;
            margin: 20px 0;
            min-height: 30px;
        }
        .correct {
            color: green;
        }
        .incorrect {
            color: red;
        }
        .result-container {
            display: none;
            margin-top: 20px;
            padding: 20px;
            background-color: #e9f7ff;
            border-radius: 15px;
            animation: fadeIn 1s;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .stars {
            font-size: 50px;
            color: gold;
            text-shadow: 0 0 5px rgba(0, 0, 0, 0.3);
            margin: 20px 0;
        }
        .progress-container {
            margin: 20px auto;
            width: 80%;
            height: 20px;
            background-color: #ddd;
            border-radius: 10px;
            overflow: hidden;
        }
        .progress-bar {
            height: 100%;
            width: 0%;
            background-color: #2c80b9;
            transition: width 0.5s;
        }
        .celebration {
            position: absolute;
            font-size: 30px;
            animation: fallDown 2s forwards;
            opacity: 0;
        }
        @keyframes fallDown {
            0% {
                transform: translateY(-50px);
                opacity: 1;
            }
            80% {
                opacity: 1;
            }
            100% {
                transform: translateY(100px);
                opacity: 0;
            }
        }
        .stats {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        .stat-item {
            background-color: #e9f7ff;
            padding: 10px;
            border-radius: 10px;
            width: 45%;
            margin: 5px;
        }
        .mode-selection {
            text-align: center;
            max-width: 600px;
            margin: 0 auto;
        }
        .mode-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin: 20px 0;
        }
        .mode-btn {
            font-size: 18px;
            padding: 15px;
            background-color: #4c9aff;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
        }
        .mode-btn:hover {
            background-color: #3a7bd5;
            transform: scale(1.02);
        }
        .focus-option {
            margin-top: 20px;
            padding: 15px;
            background-color: #e9f7ff;
            border-radius: 10px;
        }
        .focus-buttons {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
            margin: 15px 0;
        }
        .focus-btn {
            font-size: 16px;
            padding: 10px 15px;
            background-color: #5cb85c;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .focus-btn:hover {
            background-color: #4cae4c;
        }
        .focus-btn.active {
            background-color: #f0ad4e;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Procviƒçov√°n√≠ n√°sobilky a dƒõlen√≠</h1>
        
        <div id="mode-selection" class="mode-selection">
            <h1>Procviƒçov√°n√≠ matematiky</h1>
            <h2>Vyber si typ p≈ô√≠klad≈Ø:</h2>
            
            <div class="mode-options">
                <button class="mode-btn" data-mode="1">N√°sobilka a dƒõlen√≠ (1-5 a 10)</button>
                <button class="mode-btn" data-mode="2">N√°sobilka a dƒõlen√≠ (1-6 a 10)</button>
                <button class="mode-btn" data-mode="3">N√°sobilka a dƒõlen√≠ (1-7 a 10)</button>
                <button class="mode-btn" data-mode="4">N√°sobilka a dƒõlen√≠ (1-8 a 10)</button>
                <button class="mode-btn" data-mode="5">N√°sobilka a dƒõlen√≠ (1-9 a 10)</button>
                <button class="mode-btn" data-mode="6">Sƒç√≠t√°n√≠ a odƒç√≠t√°n√≠ do 100</button>
            </div>
            
            <div id="focus-option" class="focus-option" style="display: none;">
                <h3>Chce≈° procviƒçovat jen konkr√©tn√≠ ƒç√≠slo?</h3>
                <div id="focus-buttons" class="focus-buttons">
                    <!-- Tlaƒç√≠tka se generuj√≠ dynamicky podle v√Ωbƒõru re≈æimu -->
                </div>
                <button id="focus-all-btn" class="focus-btn">Procviƒçovat v≈°echna ƒç√≠sla</button>
            </div>
        </div>
        
        <div id="game-screen" style="display: none;">
            <div class="score">Body: <span id="score">0</span></div>
            <div class="progress-container">
                <div class="progress-bar" id="progress-bar"></div>
            </div>
            <div class="success-rate">√öspƒõ≈°nost: <span id="current-success-rate">0%</span></div>
            <div class="problem" id="problem"></div>
            <input type="number" id="answer" placeholder="?" min="0" max="100">
            <div>
                <button id="check-btn">Zkontrolovat</button>
            </div>
            <div class="feedback" id="feedback"></div>
        </div>
        
        <div id="result-screen" class="result-container">
            <h2>Gratuluji! Dos√°hl/a jsi 50 bod≈Ø!</h2>
            <div class="stars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
            <div class="stats">
                <div class="stat-item">
                    <h3>Spr√°vn√© odpovƒõdi</h3>
                    <div id="correct-count">0</div>
                </div>
                <div class="stat-item">
                    <h3>≈†patn√© odpovƒõdi</h3>
                    <div id="incorrect-count">0</div>
                </div>
                <div class="stat-item">
                    <h3>Celkov√Ω ƒças</h3>
                    <div id="total-time">0:00</div>
                </div>
                <div class="stat-item">
                    <h3>√öspƒõ≈°nost</h3>
                    <div id="success-rate">0%</div>
                </div>
            </div>
            <button id="restart-btn">Hr√°t znovu</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const modeSelection = document.getElementById('mode-selection');
            const focusOption = document.getElementById('focus-option');
            const focusButtons = document.getElementById('focus-buttons');
            const focusAllBtn = document.getElementById('focus-all-btn');
            const gameScreen = document.getElementById('game-screen');
            const problemElement = document.getElementById('problem');
            const answerInput = document.getElementById('answer');
            const checkButton = document.getElementById('check-btn');
            const feedbackElement = document.getElementById('feedback');
            const scoreElement = document.getElementById('score');
            const progressBar = document.getElementById('progress-bar');
            const resultScreen = document.getElementById('result-screen');
            const restartButton = document.getElementById('restart-btn');
            const correctCountElement = document.getElementById('correct-count');
            const incorrectCountElement = document.getElementById('incorrect-count');
            const totalTimeElement = document.getElementById('total-time');
            
            // Inicializace Web Audio API
            let audioContext;
            
            // Promƒõnn√© pro typy test≈Ø
           // Promƒõnn√© pro typy test≈Ø
            let currentMode = 1;
            let focusNumber = null;
            let numbers = [1, 2, 3, 4, 5, 10]; // V√Ωchoz√≠ ƒç√≠sla pro re≈æim 1
            let allNumbers = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]; // V≈°echna mo≈æn√° ƒç√≠sla
            
            // Konfigurace re≈æim≈Ø
            const modes = {
                1: { numbers: [1, 2, 3, 4, 5, 10], name: "N√°sobilka a dƒõlen√≠ (1-5 a 10)" },
                2: { numbers: [1, 2, 3, 4, 5, 6, 10], name: "N√°sobilka a dƒõlen√≠ (1-6 a 10)", focus: 6 },
                3: { numbers: [1, 2, 3, 4, 5, 6, 7, 10], name: "N√°sobilka a dƒõlen√≠ (1-7 a 10)", focus: 7 },
                4: { numbers: [1, 2, 3, 4, 5, 6, 7, 8, 10], name: "N√°sobilka a dƒõlen√≠ (1-8 a 10)", focus: 8 },
                5: { numbers: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], name: "N√°sobilka a dƒõlen√≠ (1-9 a 10)", focus: 9 },
                6: { name: "Sƒç√≠t√°n√≠ a odƒç√≠t√°n√≠ do 100" }
            };
            
            // Inicializace Audio Context p≈ôi prvn√≠ interakci u≈æivatele
            function initAudio() {
                if (!audioContext) {
                    try {
                        audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    } catch (e) {
                        console.log('Web Audio API nen√≠ podporov√°no v tomto prohl√≠≈æeƒçi.');
                    }
                }
            }
            
            // Funkce pro p≈ôehr√°n√≠ zvuk≈Ø
            function playCorrectSound() {
                if (!audioContext) return;
                
                // Zvuk pro spr√°vnou odpovƒõƒè - vesel√Ω t√≥n
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.type = 'sine';
                oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
                oscillator.frequency.exponentialRampToValueAtTime(1200, audioContext.currentTime + 0.1);
                
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.start();
                oscillator.stop(audioContext.currentTime + 0.3);
            }
            
            function playWrongSound() {
                if (!audioContext) return;
                
                // Zvuk pro ≈°patnou odpovƒõƒè - klesaj√≠c√≠ t√≥n
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.type = 'sine';
                oscillator.frequency.setValueAtTime(400, audioContext.currentTime);
                oscillator.frequency.exponentialRampToValueAtTime(200, audioContext.currentTime + 0.3);
                
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.start();
                oscillator.stop(audioContext.currentTime + 0.3);
            }
            
            function playWinSound() {
                if (!audioContext) return;
                
                // Fanf√°ra pro v√Ωhru - sekvence t√≥n≈Ø
                const notes = [523.25, 659.25, 783.99, 1046.50]; // C5, E5, G5, C6
                const durations = [0.1, 0.1, 0.1, 0.3];
                
                notes.forEach((freq, i) => {
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.type = 'sine';
                    oscillator.frequency.value = freq;
                    
                    gainNode.gain.setValueAtTime(0.3, audioContext.currentTime + (i * durations[i]));
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + ((i + 1) * durations[i]));
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    oscillator.start(audioContext.currentTime + (i * durations[i]));
                    oscillator.stop(audioContext.currentTime + ((i + 1) * durations[i]));
                });
            }
            
            let score = 0;
            let correctCount = 0;
            let incorrectCount = 0;
            let currentProblem = {};
            let startTime;
            
            // Sledov√°n√≠ jednoduch√Ωch p≈ô√≠klad≈Ø
            let usedEasyProblems = {
                multiplyByOne: false,    // N√°soben√≠ jedniƒçkou
                divideByOne: false,      // Dƒõlen√≠ jedniƒçkou
                multiplyByZero: false,   // N√°soben√≠ nulou
                divideByItself: false    // Dƒõlen√≠ ƒç√≠sla sebou sam√Ωm
            };
            
            // Inicializace v√Ωbƒõru re≈æimu
            function setupModeSelection() {
                // P≈ôid√°n√≠ event listener≈Ø pro tlaƒç√≠tka re≈æim≈Ø
                document.querySelectorAll('.mode-btn').forEach(button => {
                    button.addEventListener('click', function() {
                        const mode = parseInt(this.getAttribute('data-mode'));
                        selectMode(mode);
                    });
                });
                
                // Event listener pro tlaƒç√≠tko "Procviƒçovat v≈°echna ƒç√≠sla"
                focusAllBtn.addEventListener('click', function() {
                    focusNumber = null;
                    // Odstranƒõn√≠ zv√Ωraznƒõn√≠ u v≈°ech focus tlaƒç√≠tek
                    document.querySelectorAll('.focus-btn').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    this.classList.add('active');
                    startGame();
                });
            }
            
            // V√Ωbƒõr re≈æimu
            function selectMode(mode) {
                currentMode = mode;
                
                // Nastaven√≠ re≈æimu pro n√°sobilku a dƒõlen√≠ (re≈æimy 1-5)
                if (mode >= 1 && mode <= 5) {
                    numbers = [...modes[mode].numbers]; // Vytvo≈ôen√≠ kopie pole
                    
                    // Zobrazit mo≈ænost zamƒõ≈ôen√≠ na konkr√©tn√≠ ƒç√≠slo
                    if (mode > 1) {
                        focusOption.style.display = 'block';
                        generateFocusButtons(mode);
                    } else {
                        focusOption.style.display = 'none';
                        startGame();
                    }
                } 
                // Re≈æim sƒç√≠t√°n√≠ a odƒç√≠t√°n√≠
                else if (mode === 6) {
                    focusOption.style.display = 'none';
                    startGame();
                }
            }
            
            // Generov√°n√≠ tlaƒç√≠tek pro zamƒõ≈ôen√≠ na konkr√©tn√≠ ƒç√≠slo
            function generateFocusButtons(mode) {
                focusButtons.innerHTML = '';
                
                // P≈ôid√°n√≠ tlaƒç√≠tka pro zamƒõ≈ôen√≠ na posledn√≠ p≈ôidan√© ƒç√≠slo
                const focusBtn = document.createElement('button');
                focusBtn.className = 'focus-btn';
                focusBtn.textContent = `Procviƒçovat jen ƒç√≠slo ${modes[mode].focus}`;
                focusBtn.addEventListener('click', function() {
                    document.querySelectorAll('.focus-btn').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    this.classList.add('active');
                    focusNumber = modes[mode].focus;
                    startGame();
                });
                focusButtons.appendChild(focusBtn);
            }
            
            // Spu≈°tƒõn√≠ hry
            function startGame() {
                initAudio(); // Inicializace zvuku p≈ôi startu hry
                
                // Skryt√≠ v√Ωbƒõru re≈æimu a zobrazen√≠ hry
                modeSelection.style.display = 'none';
                gameScreen.style.display = 'block';
                
                // Reset sk√≥re a statistik
                score = 0;
                correctCount = 0;
                incorrectCount = 0;
                scoreElement.textContent = score;
                updateProgressBar();
                
                // Reset jednoduch√Ωch p≈ô√≠klad≈Ø
                usedEasyProblems = {
                    multiplyByOne: false,
                    divideByOne: false,
                    multiplyByZero: false,
                    divideByItself: false
                };
                
                // Nastaven√≠ zaƒç√°tku ƒçasu
                startTime = new Date();
                
                // Generov√°n√≠ prvn√≠ho p≈ô√≠kladu
                generateProblem();
            }
            
            // Funkce na kontrolu, zda je p≈ô√≠klad jednoduch√Ω
            function isEasyProblem(problem) {
                // N√°soben√≠ jedniƒçkou
                if (problem.operation === 'x' && (problem.num1 === 1 || problem.num2 === 1)) {
                    return 'multiplyByOne';
                }
                // Dƒõlen√≠ jedniƒçkou
                if (problem.operation === '√∑' && problem.num2 === 1) {
                    return 'divideByOne';
                }
                // N√°soben√≠ nulou
                if (problem.operation === 'x' && (problem.num1 === 0 || problem.num2 === 0)) {
                    return 'multiplyByZero';
                }
                // Dƒõlen√≠ ƒç√≠sla sebou sam√Ωm (s v√Ωjimkou 0)
                if (problem.operation === '√∑' && problem.num1 === problem.num2 && problem.num1 !== 0) {
                    return 'divideByItself';
                }
                return null;
            }
            
            function generateProblem() {
                // Re≈æim sƒç√≠t√°n√≠ a odƒç√≠t√°n√≠ do 100
                if (currentMode === 6) {
                    generateAddSubtractProblem();
                    return;
                }
                
                let attempts = 0;
                let tempProblem;
                let problemType;
                
                // Pokus o vygenerov√°n√≠ p≈ô√≠kladu, kter√Ω nen√≠ jednoduch√Ω nebo je≈°tƒõ nebyl pou≈æit
                do {
                    attempts++;
                    
                    // Re≈æim n√°sobilky a dƒõlen√≠
                    // V re≈æimu zamƒõ≈ôen√≠ na konkr√©tn√≠ ƒç√≠slo
                    if (focusNumber !== null) {
                        // N√°hodnƒõ vybere operaci (n√°sobilka nebo dƒõlen√≠)
                        const isMultiplication = Math.random() < 0.5;
                        
                        if (isMultiplication) {
                            // Pro n√°sobilku: jedno ƒç√≠slo je zamƒõ≈ôen√© ƒç√≠slo, druh√© je libovoln√© od 0 do 10
                            const otherNumber = allNumbers[Math.floor(Math.random() * allNumbers.length)];
                            
                            // N√°hodnƒõ rozhodni, zda bude zamƒõ≈ôen√© ƒç√≠slo prvn√≠ nebo druh√©
                            if (Math.random() < 0.5) {
                                tempProblem = {
                                    num1: focusNumber,
                                    num2: otherNumber,
                                    operation: 'x',
                                    answer: focusNumber * otherNumber
                                };
                            } else {
                                tempProblem = {
                                    num1: otherNumber,
                                    num2: focusNumber,
                                    operation: 'x',
                                    answer: otherNumber * focusNumber
                                };
                            }
                        } else {
                            // Pro dƒõlen√≠: v≈ædy pou≈æ√≠t zamƒõ≈ôen√© ƒç√≠slo jako dƒõlitel
                            // Vyhni se dƒõlen√≠ nulou
                            if (focusNumber === 0) {
                                // Pokud je zamƒõ≈ôen√© ƒç√≠slo 0, generujeme n√°soben√≠ m√≠sto dƒõlen√≠
                                const randomNumber = allNumbers[Math.floor(Math.random() * allNumbers.length)];
                                tempProblem = {
                                    num1: randomNumber,
                                    num2: 0,
                                    operation: 'x',
                                    answer: 0
                                };
                            } else {
                                // V√Ωsledek dƒõlen√≠ mus√≠ b√Ωt v rozsahu 0-10
                                const quotient = allNumbers[Math.floor(Math.random() * allNumbers.length)];
                                const num1 = quotient * focusNumber;
                                
                                tempProblem = {
                                    num1: num1,
                                    num2: focusNumber,
                                    operation: '√∑',
                                    answer: quotient
                                };
                            }
                        }
                    }
                    // Standardn√≠ re≈æim bez zamƒõ≈ôen√≠
                    else {
                        // N√°hodnƒõ vybere operaci (n√°sobilka nebo dƒõlen√≠)
                        const isMultiplication = Math.random() < 0.5;
                        
                        if (isMultiplication) {
                            // N√°sobilka: jedno ƒç√≠slo z definovan√©ho rozsahu, druh√© libovoln√© od 0 do 10
                            const rangeNumber = numbers[Math.floor(Math.random() * numbers.length)];
                            const otherNumber = allNumbers[Math.floor(Math.random() * allNumbers.length)];
                            
                            // N√°hodnƒõ rozhodni, kter√© ƒç√≠slo bude z definovan√©ho rozsahu
                            if (Math.random() < 0.5) {
                                tempProblem = {
                                    num1: rangeNumber,
                                    num2: otherNumber,
                                    operation: 'x',
                                    answer: rangeNumber * otherNumber
                                };
                            } else {
                                tempProblem = {
                                    num1: otherNumber,
                                    num2: rangeNumber,
                                    operation: 'x',
                                    answer: otherNumber * rangeNumber
                                };
                            }
                        } else {
                            // Dƒõlen√≠: dƒõlitel z definovan√©ho rozsahu, v√Ωsledek mus√≠ b√Ωt 0-10
                            const divisor = numbers[Math.floor(Math.random() * numbers.length)];
                            
                            // Vyhni se dƒõlen√≠ nulou
                            if (divisor === 0) {
                                // Pokud je dƒõlitel 0, generujeme n√°soben√≠ m√≠sto dƒõlen√≠
                                const randomNumber = allNumbers[Math.floor(Math.random() * allNumbers.length)];
                                tempProblem = {
                                    num1: randomNumber,
                                    num2: 0,
                                    operation: 'x',
                                    answer: 0
                                };
                            } else {
                                // V√Ωsledek dƒõlen√≠ mus√≠ b√Ωt v rozsahu 0-10
                                const quotient = allNumbers[Math.floor(Math.random() * allNumbers.length)];
                                const dividend = quotient * divisor;
                                
                                tempProblem = {
                                    num1: dividend,
                                    num2: divisor,
                                    operation: '√∑',
                                    answer: quotient
                                };
                            }
                        }
                    }
                    
                    problemType = isEasyProblem(tempProblem);
                    
                    // Pokud je p≈ô√≠klad jednoduch√Ω a u≈æ byl pou≈æit, pokraƒçuj v generov√°n√≠
                    if (problemType && usedEasyProblems[problemType]) {
                        continue;
                    }
                    
                    // Pokud jsme se pokusili 15x a po≈ô√°d m√°me jednoduch√Ω p≈ô√≠klad, pou≈æij ho
                    if (attempts > 15) {
                        break;
                    }
                    
                } while (problemType && usedEasyProblems[problemType]);
                
                // Pokud je p≈ô√≠klad jednoduch√Ω, oznaƒç ho jako pou≈æit√Ω
                if (problemType) {
                    usedEasyProblems[problemType] = true;
                }
                
                currentProblem = tempProblem;
                
                problemElement.textContent = `${currentProblem.num1} ${currentProblem.operation} ${currentProblem.num2} = `;
                answerInput.value = '';
                answerInput.focus();
            }
            
            // Generov√°n√≠ p≈ô√≠kladu pro sƒç√≠t√°n√≠ a odƒç√≠t√°n√≠ do 100
            function generateAddSubtractProblem() {
                // N√°hodnƒõ vybere operaci (sƒç√≠t√°n√≠ nebo odƒç√≠t√°n√≠)
                const isAddition = Math.random() < 0.5;
                
                if (isAddition) {
                    // Sƒç√≠t√°n√≠
                    const num1 = Math.floor(Math.random() * 50) + 1; // 1-50
                    const num2 = Math.floor(Math.random() * 50) + 1; // 1-50
                    
                    currentProblem = {
                        num1: num1,
                        num2: num2,
                        operation: '+',
                        answer: num1 + num2
                    };
                } else {
                    // Odƒç√≠t√°n√≠ (zajist√≠me, ≈æe v√Ωsledek bude kladn√Ω)
                    const num2 = Math.floor(Math.random() * 50) + 1; // 1-50
                    const num1 = num2 + Math.floor(Math.random() * 50) + 1; // v≈ædy vƒõt≈°√≠ ne≈æ num2
                    
                    currentProblem = {
                        num1: num1,
                        num2: num2,
                        operation: '-',
                        answer: num1 - num2
                    };
                }
                
                problemElement.textContent = `${currentProblem.num1} ${currentProblem.operation} ${currentProblem.num2} = `;
                answerInput.value = '';
                answerInput.focus();
            }
            
            function checkAnswer() {
                const userAnswer = parseInt(answerInput.value);
                
                if (isNaN(userAnswer)) {
                    feedbackElement.textContent = 'Zadej ƒç√≠slo!';
                    feedbackElement.className = 'feedback incorrect';
                    return;
                }
                
                if (userAnswer === currentProblem.answer) {
                    // Spr√°vn√° odpovƒõƒè
                    score++;
                    correctCount++;
                    feedbackElement.textContent = 'Spr√°vnƒõ!';
                    feedbackElement.className = 'feedback correct';
                    createCelebration();
                    // Zvukov√° i vizu√°ln√≠ zpƒõtn√° vazba
                    playCorrectSound();
                    flashBackground('correct');
                } else {
                    // ≈†patn√° odpovƒõƒè
                    score = Math.max(0, score - 1);
                    incorrectCount++;
                    feedbackElement.textContent = `≈†patnƒõ! Spr√°vn√° odpovƒõƒè je ${currentProblem.answer}.`;
                    feedbackElement.className = 'feedback incorrect';
                    // Zvukov√° i vizu√°ln√≠ zpƒõtn√° vazba
                    playWrongSound();
                    flashBackground('incorrect');
                }
                
                scoreElement.textContent = score;
                updateProgressBar();
                updateSuccessRate();
                
                // Kontrola, zda bylo dosa≈æeno 50 bod≈Ø
                if (score >= 50) {
                    endGame();
                } else {
                    // Po kr√°tk√© pauze generuje nov√Ω p≈ô√≠klad
                    setTimeout(generateProblem, 1500);
                }
            }
            
            // Funkce pro vizu√°ln√≠ zpƒõtnou vazbu m√≠sto zvuku
            function flashBackground(type) {
                const container = document.querySelector('.container');
                const originalBackground = container.style.backgroundColor;
                
                if (type === 'correct') {
                    container.style.backgroundColor = '#c8f7c5'; // Zelen√© pozad√≠ p≈ôi spr√°vn√© odpovƒõdi
                } else if (type === 'incorrect') {
                    container.style.backgroundColor = '#ffcccb'; // ƒåerven√© pozad√≠ p≈ôi ≈°patn√© odpovƒõdi
                } else if (type === 'win') {
                    container.style.backgroundColor = '#fffacd'; // ≈Ωlut√© pozad√≠ p≈ôi v√Ωh≈ôe
                }
                
                setTimeout(() => {
                    container.style.backgroundColor = originalBackground;
                }, 300);
            }
            
            function updateSuccessRate() {
                const total = correctCount + incorrectCount;
                if (total > 0) {
                    const rate = Math.round((correctCount / total) * 100);
                    document.getElementById('current-success-rate').textContent = `${rate}%`;
                }
            }
            
            function updateProgressBar() {
                const progress = (score / 50) * 100;
                progressBar.style.width = `${progress}%`;
            }
            
            function createCelebration() {
                const container = document.querySelector('.container');
                const celebration = document.createElement('div');
                celebration.className = 'celebration';
                
                // N√°hodn√° pozice horizont√°lnƒõ
                const xPos = Math.random() * 80 + 10;
                celebration.style.left = `${xPos}%`;
                
                // N√°hodn√Ω emotikon pro oslavu
                const emojis = ['üéâ', '‚≠ê', 'üëç', 'ü•≥', 'üòä', 'üèÜ'];
                celebration.textContent = emojis[Math.floor(Math.random() * emojis.length)];
                
                container.appendChild(celebration);
                
                // Odstranƒõn√≠ animace po dokonƒçen√≠
                setTimeout(() => {
                    container.removeChild(celebration);
                }, 2000);
            }
            
            function endGame() {
                const endTime = new Date();
                const timeSpent = Math.floor((endTime - startTime) / 1000);
                const minutes = Math.floor(timeSpent / 60);
                const seconds = timeSpent % 60;
                
                totalTimeElement.textContent = `${minutes}:${seconds < 10 ? '0' + seconds : seconds}`;
                correctCountElement.textContent = correctCount;
                incorrectCountElement.textContent = incorrectCount;
                
                // V√Ωpoƒçet a zobrazen√≠ √∫spƒõ≈°nosti
                const total = correctCount + incorrectCount;
                if (total > 0) {
                    const rate = Math.round((correctCount / total) * 100);
                    document.getElementById('success-rate').textContent = `${rate}%`;
                }
                
                // Vizu√°ln√≠ efekt a zvuk
                flashBackground('win');
                playWinSound();
                
                gameScreen.style.display = 'none';
                resultScreen.style.display = 'block';
                
                // P≈ôidat extra oslavnou animaci p≈ôi dokonƒçen√≠
                celebrateWin();
            }
            
            // Funkce pro oslavu v√Ωhry
            function celebrateWin() {
                const container = document.querySelector('.container');
                
                // P≈ôidat nƒõkolik oslavn√Ωch emotikon≈Ø najednou
                for (let i = 0; i < 20; i++) {
                    setTimeout(() => {
                        createCelebration();
                    }, i * 100);
                }
                
                // Pulzuj√≠c√≠ efekt pro hvƒõzdiƒçky
                const stars = document.querySelector('.stars');
                stars.style.animation = 'pulse 0.7s infinite alternate';
                
                // P≈ôidat animaci pulzov√°n√≠
                const style = document.createElement('style');
                style.textContent = `
                    @keyframes pulse {
                        0% { transform: scale(1); }
                        100% { transform: scale(1.1); }
                    }
                `;
                document.head.appendChild(style);
            }
            
            function resetGame() {
                // Skryt√≠ v√Ωsledkov√© obrazovky
                resultScreen.style.display = 'none';
                // N√°vrat na v√Ωbƒõr re≈æimu
                modeSelection.style.display = 'block';
                gameScreen.style.display = 'none';
                
                // Reset zv√Ωraznƒõn√≠ tlaƒç√≠tek
                document.querySelectorAll('.focus-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                
                // Reset zamƒõ≈ôen√≠
                focusNumber = null;
            }
            
            // Event listenery
            checkButton.addEventListener('click', function() {
                initAudio(); // Inicializace zvuku p≈ôi prvn√≠ interakci u≈æivatele
                checkAnswer();
            });
            
            restartButton.addEventListener('click', resetGame);
            
            answerInput.addEventListener('keyup', function(event) {
                if (event.key === 'Enter') {
                    initAudio(); // Inicializace zvuku p≈ôi prvn√≠ interakci u≈æivatele
                    checkAnswer();
                }
            });
            
            // Inicializace UI
            setupModeSelection();
        });
    </script>
</body>
</html>